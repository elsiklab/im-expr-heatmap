#!/usr/bin/env Rscript


library(d3heatmap)
library(data.table)
library(reshape2)


args <- commandArgs(trailingOnly = TRUE)
if(length(args)<2) {
    stop("Usage: intermine2heatmap input.txt [output.html]")
}


x=fread(args[1])
setnames(x,c("transcriptid","sra","sample_name","tissue","brenda","fpkm","normalized_counts","raw_counts"))


z=acast(x,transcriptid~tissue,value.var="fpkm")
filename=ifelse(length(args)>=3,args[3],'output.html')

widget=d3heatmap(log(z+1))
saveWidet(widget,file=filename)



